{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2>교사 로그인</h2>
  {% if error %}<div class="error">{{ error }}</div>{% endif %}

  <form method="post">
    아이디<br>
    <input name="username" autocomplete="username"><br><br>

    비밀번호<br>
    <div class="pw-wrap">
      <input id="pwInput"
             type="password"
             name="password"
             autocomplete="current-password"
             class="pw-input-in">

      <button id="pwToggleBtn"
              class="pw-in-toggle"
              type="button"
              aria-label="비밀번호 보기/숨기기"
              aria-pressed="false">
        <span id="eyeOn" class="eye-icon is-active" aria-hidden="true">
          <!-- IoMdEye -->
          <svg viewBox="0 0 512 512" width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M256 105c-101.8 0-188.4 62.4-224 151 35.6 88.6 122.2 151 224 151s188.4-62.4 224-151c-35.6-88.6-122.2-151-224-151zm0 251.7c-56 0-101.8-45.3-101.8-100.7S200 155.3 256 155.3 357.8 200.6 357.8 256 312 356.7 256 356.7zm0-161.1c-33.6 0-61.1 27.2-61.1 60.4s27.5 60.4 61.1 60.4 61.1-27.2 61.1-60.4-27.5-60.4-61.1-60.4z"></path>
          </svg>
        </span>

        <span id="eyeOff" class="eye-icon" aria-hidden="true">
          <!-- IoMdEyeOff -->
          <svg viewBox="0 0 512 512" width="20" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path d="M256.1 144.8c56.2 0 101.9 45.3 101.9 101.1 0 13.1-2.6 25.5-7.3 37l59.5 59c30.8-25.5 55-58.4 69.9-96-35.3-88.7-122.3-151.6-224.2-151.6-28.5 0-55.8 5.1-81.1 14.1l44 43.7c11.6-4.6 24.1-7.3 37.3-7.3zM52.4 89.7l46.5 46.1 9.4 9.3c-33.9 26-60.4 60.8-76.3 100.8 35.2 88.7 122.2 151.6 224.1 151.6 31.6 0 61.7-6.1 89.2-17l8.6 8.5 59.7 59 25.9-25.7L78.2 64 52.4 89.7zM165 201.4l31.6 31.3c-1 4.2-1.6 8.7-1.6 13.1 0 33.5 27.3 60.6 61.1 60.6 4.5 0 9-.6 13.2-1.6l31.6 31.3c-13.6 6.7-28.7 10.7-44.8 10.7-56.2 0-101.9-45.3-101.9-101.1 0-15.8 4.1-30.7 10.8-44.3zm87.8-15.7l64.2 63.7.4-3.2c0-33.5-27.3-60.6-61.1-60.6l-3.5.1z"></path>
          </svg>
        </span>
      </button>
    </div>

    <br>

    <button>로그인</button>
  </form>

  <hr style="margin:18px 0;">
  <div>
    아직 계정이 없으신가요?<br>
    <a href="/teacher/signup">교사 회원가입</a>
  </div>
</div>

<style>
  /* input 안에 아이콘을 넣기 위한 래퍼 */
  .pw-wrap{
    position: relative;
    width: 100%;
  }

  /* 아이콘이 들어갈 공간 확보(오른쪽 padding) */
  .pw-input-in{
    width: 100%;
    padding-right: 44px; /* 아이콘 자리 */
    box-sizing: border-box;
  }

  /* input 오른쪽 끝에 겹쳐지는 아이콘 버튼 */
  .pw-in-toggle{
    position: absolute;
    top: 50%;
    right: 10px;
    transform: translateY(-50%);

    width: 28px;
    height: 28px;
    padding: 0;
    border: none;
    background: transparent;

    display: flex;
    align-items: center;
    justify-content: center;

    cursor: pointer;
    color: #6b7280; /* 기본: 회색 */
    transition: color 140ms ease;

    /* 흔들림 방지: 버튼 내부 레이아웃/폰트 영향 제거 */
    line-height: 0;
    font-size: 0;
    box-sizing: border-box;
    flex-shrink: 0;
  }

  /* hover 시 아이콘 색: 회색 -> 검정 */
  .pw-in-toggle:hover{
    color: #111827;
  }

  /* 키보드 접근성: 포커스 링 */
  .pw-in-toggle:focus-visible{
    outline: 2px solid rgba(59, 130, 246, 0.35);
    outline-offset: 2px;
    border-radius: 8px;
    color: #111827;
  }

  /* 아이콘 전환 애니메이션:
     - 두 아이콘을 같은 위치에 겹쳐두고
     - opacity/scale로 부드럽게 교체
  */
  .eye-icon{
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;

    opacity: 0;
    transform: scale(0.92);
    transition: opacity 160ms ease, transform 160ms ease;

    pointer-events: none; /* 아이콘 자체 클릭 방지 */
  }

  .eye-icon.is-active{
    opacity: 1;
    transform: scale(1);
  }

  /* SVG 크기/정렬 안정 */
  .eye-icon svg{
    display: block;
  }

  /* 터치 하이라이트만 제거 (애니메이션은 유지) */
  .pw-in-toggle, .pw-in-toggle *{
    -webkit-tap-highlight-color: transparent;
  }

  /* 모션 최소화 선호 사용자 배려 */
  @media (prefers-reduced-motion: reduce){
    .pw-in-toggle{
      transition: none;
    }
    .eye-icon{
      transition: none;
    }
  }
</style>

<script>
  (function(){
    const input = document.getElementById('pwInput');
    const btn = document.getElementById('pwToggleBtn');
    const eyeOn = document.getElementById('eyeOn');   // 비밀번호 숨김 상태(eye) 표시용
    const eyeOff = document.getElementById('eyeOff'); // 비밀번호 보임 상태(eye-off) 표시용
    if (!input || !btn || !eyeOn || !eyeOff) return;

    function setState(show){
      // show=true  => 비밀번호를 텍스트로 표시(보임)
      // show=false => 비밀번호를 password로 표시(숨김)
      input.type = show ? 'text' : 'password';
      btn.setAttribute('aria-pressed', show ? 'true' : 'false');

      // 애니메이션: active 클래스만 토글 (display:none 사용하지 않음)
      if (show){
        eyeOn.classList.remove('is-active');
        eyeOff.classList.add('is-active');
      } else {
        eyeOff.classList.remove('is-active');
        eyeOn.classList.add('is-active');
      }
    }

    // 초기: 숨김
    setState(false);

    btn.addEventListener('click', () => {
      const willShow = (input.type === 'password');
      setState(willShow);
    });
  })();
</script>

{% endblock %}
