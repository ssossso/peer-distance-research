{% extends "base.html" %}
{% block content %}
<div class="card" style="max-width:860px; text-align:left;">
  <h2 style="margin:0 0 10px 0; text-align:center;">êµì‚¬ ë°°ì¹˜ ê¸°ë¡ (ë§ˆë¬´ë¦¬)</h2>

  <div class="subtitle" style="margin-bottom:12px;">
    ì†Œíˆê°€ ë…¼ë¬¸ì— ì¨ë¨¹ì„ ìˆ˜ë„ ìˆëŠ” ê±°>< ëŒ€ì¶© ë¶€ë‹´ ì—†ì´ ë‹µ í•´ì£¼ì„¸ìš”ğŸ™‚ ì§„ì§œ ê³ ë§ˆì›Œìš”ğŸ’™
  </div>

  <form method="post" id="completeForm">
    <input type="hidden" name="duration_ms" id="duration_ms" value="0">

    <div style="border:1px solid #e5e7eb; border-radius:12px; padding:12px; background:#fafafa; margin-bottom:12px;">
      <div style="font-weight:800; margin-bottom:8px;">í™•ì‹ ë„</div>

      <input type="range" name="confidence_score" min="0" max="100" value="50"
             style="width:100%;">

      <!-- ìˆ«ì/ì˜ˆì‹œ ë¬¸êµ¬ëŠ” ìš”ì²­ëŒ€ë¡œ ì œê±° -->
    </div>


  <form method="post" id="completeForm">
    <input type="hidden" name="duration_ms" id="duration_ms" value="0">

    <div style="border:1px solid #e5e7eb; border-radius:12px; padding:12px; background:#fafafa; margin-bottom:12px;">
      <div style="font-weight:800; margin-bottom:8px;">í™•ì‹ ë„(0~100)</div>
      <input type="number" name="confidence_score" min="0" max="100" value="0"
             style="width:140px; padding:8px 10px; border-radius:10px; border:1px solid #d1d5db;">
      <div class="muted" style="font-size:12px; margin-top:6px;">
        ì˜ˆ: 0(ì „í˜€ í™•ì‹  ì—†ìŒ) ~ 100(ë§¤ìš° í™•ì‹ )
      </div>
    </div>

    <div style="border:1px solid #e5e7eb; border-radius:12px; padding:12px; background:#fafafa; margin-bottom:12px;">
      <div style="font-weight:800; margin-bottom:8px;">ìƒí™œì§€ë„ ê°œì… ìš°ì„ ìˆœìœ„(ì„ íƒ, ìµœëŒ€ 3ëª…)</div>

      <datalist id="studentNames">
        {% for s in students %}
          <option value="{{ s.name }}"></option>
        {% endfor %}
      </datalist>

      <div style="display:grid; grid-template-columns: 120px 1fr; gap:10px; align-items:center;">
        <div style="font-weight:700;">1ìˆœìœ„</div>
        <input name="priority_1" list="studentNames" placeholder="í•™ìƒ ì´ë¦„ ì…ë ¥"
               style="padding:8px 10px; border-radius:10px; border:1px solid #d1d5db;">

        <div style="font-weight:700;">2ìˆœìœ„</div>
        <input name="priority_2" list="studentNames" placeholder="í•™ìƒ ì´ë¦„ ì…ë ¥"
               style="padding:8px 10px; border-radius:10px; border:1px solid #d1d5db;">

        <div style="font-weight:700;">3ìˆœìœ„</div>
        <input name="priority_3" list="studentNames" placeholder="í•™ìƒ ì´ë¦„ ì…ë ¥"
               style="padding:8px 10px; border-radius:10px; border:1px solid #d1d5db;">
      </div>

      <div class="muted" style="font-size:12px; margin-top:8px;">
        í•™ìƒ ì´ë¦„ì€ ìë™ì™„ì„± ëª©ë¡ì—ì„œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ê³µë€ ê°€ëŠ¥)
      </div>
    </div>

    <div style="display:flex; gap:8px;">
      <button type="submit" style="flex:1;">ê¸°ë¡ ì €ì¥ ë° ì¢…ë£Œ</button>
      <a class="btn" href="/teacher/class/{{ run.class_code }}?sid={{ run.session_id }}"
         style="flex:1; text-align:center; display:inline-flex; align-items:center; justify-content:center;">
        ëŒì•„ê°€ê¸°
      </a>
    </div>
  </form>
</div>

<script>
  // í˜ì´ì§€ ì§„ì… ì‹œì ë¶€í„° ì œì¶œê¹Œì§€ ì‹œê°„ ì¸¡ì •
  const startedAt = Date.now();
  document.getElementById('completeForm').addEventListener('submit', () => {
    const ms = Math.max(0, Date.now() - startedAt);
    document.getElementById('duration_ms').value = String(ms);
  });
</script>
{% endblock %}
